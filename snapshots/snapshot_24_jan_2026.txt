П. 0: Концепция "Единого Источника Истины" (Single Source of Truth)
Чтобы система не «рассыпалась», мы разделяем Данные, Состояние и Хранение.

Данные (OData v4 / v2): Это сырая информация из SAP CAP. Мы не храним её в контроллерах. Мы просто указываем UI-компонентам «куда смотреть» (Binding).

Состояние (UI Model ui>): Это «оперативная память» портала. Здесь лежит selectedEmployeeID и currentTab. Все карточки смотрят сюда, чтобы понять, что им показывать прямо сейчас.

Хранение (localStorage): Это «длинная память». Она нужна только для того, чтобы при нажатии F5 заполнить UI Model начальными значениями.

Схема взаимодействия:
Действие: Ты нажал кнопку в таблице.

Обновление: BaseController обновляет ui>/selectedEmployeeID.

Реакция:

Host сохраняет ID в localStorage.

EmployeeStrip видит новый ID, делает bindElement и подтягивает Имя/Левел из OData.

FinanceCards видят новый ID и фильтруют зарплаты.

П. 1: Пошаговый план реализации
Двигаемся итерациями. После каждого шага — проверка «в полях».

Шаг 1: Реализация "Умного" заголовка (HeaderCard)
Вместо статичного заголовка научим HeaderCard показывать имя выбранного сотрудника. Это подтвердит, что subscribe и ui> модель работают в связке.

Действие: Добавить в HeaderCard подписку на Employee_Selected.

Проверка: Выбираешь сотрудника в таблице — HeaderCard мгновенно меняет текст.

Шаг 2: Динамический Layout (Visibility Management)
Настроим Shell так, чтобы карточки появлялись и исчезали в зависимости от таба.

Действие: Привязать свойство visible контейнеров в Shell.view.xml к {ui>/currentTab}.

Проверка: На вкладке "Staff" видна таблица, на вкладке "Finance" — она исчезает.

Шаг 3: Создание EmployeeStrip (Карточка-контекст)
Эта карточка станет "лицом" выбранного сотрудника на всех вкладках, кроме главной.

Действие: Создать новую Component-карточку. В её контроллере реализовать bindElement к OData v4 на основе selectedEmployeeID.

Проверка: При переходе на "Finance" ты видишь карточку с фото/именем/левелом именно того человека, которого выбрал ранее.

Шаг 4: Связка с Финансами (OData v2)
Самый сложный технически этап.

Действие: Настроить фильтрацию в финансовых карточках. Т.к. это OData v2, нам нужно будет передать ID в параметры запроса или применить sap.ui.model.Filter.

Проверка: Видишь зарплату только выбранного сотрудника.

Шаг 5: Кнопка сброса (Reset)
Действие: Добавить "X" или кнопку "Back to List" в EmployeeStrip.

Проверка: Нажал — ID стерся, localStorage очистился, портал вернул тебя на общую таблицу Staff.